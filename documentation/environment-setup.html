<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Environment Setup Guide</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #555;
            margin-top: 25px;
        }
        code {
            background-color: #f1f2f6;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 15px 0;
        }
        pre code {
            background-color: transparent;
            padding: 0;
            color: inherit;
        }
        .file-tree {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #6c757d;
            font-family: monospace;
            margin: 15px 0;
        }
        .step-box {
            background-color: #e8f5e8;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid #4caf50;
        }
        .step-box h4 {
            margin-top: 0;
            color: #2e7d32;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        .alert-info {
            background-color: #e3f2fd;
            border-color: #2196f3;
            color: #0277bd;
        }
        .alert-warning {
            background-color: #fff3e0;
            border-color: #ff9800;
            color: #ef6c00;
        }
        .alert-success {
            background-color: #e8f5e8;
            border-color: #4caf50;
            color: #2e7d32;
        }
        .alert-danger {
            background-color: #ffebee;
            border-color: #f44336;
            color: #c62828;
        }
        .platform-tabs {
            display: flex;
            margin: 20px 0 0 0;
            border-bottom: 1px solid #ddd;
        }
        .platform-tab {
            padding: 10px 20px;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-bottom: none;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 6px 6px 0 0;
        }
        .platform-tab.active {
            background-color: white;
            border-bottom: 1px solid white;
            margin-bottom: -1px;
        }
        .platform-content {
            display: none;
            padding: 20px;
            border: 1px solid #ddd;
            border-top: none;
            background-color: white;
        }
        .platform-content.active {
            display: block;
        }
        .toc {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin: 20px 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 5px 0;
        }
        .toc a {
            text-decoration: none;
            color: #3498db;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Environment Setup Guide</h1>
        
        <div class="toc">
            <h3>Table of Contents</h3>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#prerequisites">Prerequisites</a></li>
                <li><a href="#installation">Installation Steps</a></li>
                <li><a href="#project-setup">Project Setup</a></li>
                <li><a href="#configuration">Initial Configuration</a></li>
                <li><a href="#verification">Verification</a></li>
                <li><a href="#troubleshooting">Troubleshooting</a></li>
                <li><a href="#next-steps">Next Steps</a></li>
            </ul>
        </div>

        <h2 id="overview">Overview</h2>
        <p>This guide walks you through setting up a complete development environment for the Payment API Testing Framework. By the end of this guide, you'll have a fully functional testing environment ready to execute payment API tests.</p>

        <div class="alert alert-info">
            <strong>Estimated Setup Time:</strong> 15-30 minutes depending on your system and internet connection.
        </div>

        <h2 id="prerequisites">Prerequisites</h2>

        <h3>System Requirements</h3>
        <table>
            <thead>
                <tr>
                    <th>Component</th>
                    <th>Minimum Version</th>
                    <th>Recommended Version</th>
                    <th>Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Python</td>
                    <td>3.8</td>
                    <td>3.9+</td>
                    <td>Required for framework execution</td>
                </tr>
                <tr>
                    <td>pip</td>
                    <td>20.0</td>
                    <td>Latest</td>
                    <td>Python package manager</td>
                </tr>
                <tr>
                    <td>Git</td>
                    <td>2.20</td>
                    <td>Latest</td>
                    <td>Version control (optional)</td>
                </tr>
                <tr>
                    <td>RAM</td>
                    <td>4GB</td>
                    <td>8GB+</td>
                    <td>For parallel test execution</td>
                </tr>
                <tr>
                    <td>Disk Space</td>
                    <td>500MB</td>
                    <td>1GB+</td>
                    <td>For dependencies and test results</td>
                </tr>
            </tbody>
        </table>

        <h3>Check Current Python Installation</h3>
        <div class="platform-tabs">
            <div class="platform-tab active" onclick="showPlatform('windows')">Windows</div>
            <div class="platform-tab" onclick="showPlatform('macos')">macOS</div>
            <div class="platform-tab" onclick="showPlatform('linux')">Linux</div>
        </div>
        
        <div id="windows" class="platform-content active">
            <pre><code># Check Python version
python --version
# or
python3 --version

# Check pip version
pip --version
# or
pip3 --version</code></pre>
        </div>
        
        <div id="macos" class="platform-content">
            <pre><code># Check Python version
python3 --version

# Check pip version
pip3 --version

# If Python 3 is not installed, install via Homebrew:
brew install python3</code></pre>
        </div>
        
        <div id="linux" class="platform-content">
            <pre><code># Check Python version
python3 --version

# Check pip version
pip3 --version

# If Python 3 is not installed (Ubuntu/Debian):
sudo apt update
sudo apt install python3 python3-pip

# If Python 3 is not installed (CentOS/RHEL):
sudo yum install python3 python3-pip</code></pre>
        </div>

        <h2 id="installation">Installation Steps</h2>

        <div class="step-box">
            <h4>Step 1: Create Project Directory</h4>
            <p>Create a dedicated directory for the payment testing framework:</p>
            <pre><code># Create project directory
mkdir payment-api-tester
cd payment-api-tester

# Verify you're in the correct directory
pwd</code></pre>
        </div>

        <div class="step-box">
            <h4>Step 2: Create Python Virtual Environment</h4>
            <p>Create an isolated Python environment for the project:</p>
            <pre><code># Create virtual environment
python3 -m venv venv

# Activate virtual environment
# Windows:
venv\Scripts\activate

# macOS/Linux:
source venv/bin/activate

# Verify activation (should show virtual environment path)
which python</code></pre>
            
            <div class="alert alert-success">
                <strong>Success Indicator:</strong> Your command prompt should now show <code>(venv)</code> at the beginning, indicating the virtual environment is active.
            </div>
        </div>

        <div class="step-box">
            <h4>Step 3: Install Core Dependencies</h4>
            <p>Install the required Python packages:</p>
            <pre><code># Upgrade pip to latest version
pip install --upgrade pip

# Install core dependencies
pip install pandas==2.1.0
pip install sqlalchemy==2.0.20
pip install worldline-acquiring-sdk-python==1.3.0

# Install testing dependencies
pip install pytest==7.4.0
pip install pytest-cov==4.1.0
pip install pytest-mock==3.11.1

# Install dashboard dependencies (optional)
pip install dash==2.14.0
pip install plotly==5.15.0

# Create requirements file for future reference
pip freeze > requirements.txt</code></pre>
        </div>

        <div class="step-box">
            <h4>Step 4: Create Project Structure</h4>
            <p>Set up the directory structure for the framework:</p>
            <pre><code># Create main directories
mkdir src
mkdir config
mkdir outputs
mkdir tests
mkdir documentation

# Create source code subdirectories
mkdir src/request_builders

# Create initial files
touch src/__init__.py
touch src/main.py
touch src/data_loader.py
touch src/utils.py
touch src/api_calls.py
touch src/results_handler.py
touch src/response_utils.py
touch src/request_builders/__init__.py

# Create configuration files
touch config/tests.csv
touch config/environments.csv
touch config/merchants.csv
touch config/cards.csv
touch config/address.csv
touch config/networktoken.csv
touch config/threeddata.csv</code></pre>

            <p>Your project structure should now look like this:</p>
            <div class="file-tree">
payment-api-tester/
├── venv/                          # Virtual environment
├── src/                           # Source code
│   ├── __init__.py
│   ├── main.py
│   ├── data_loader.py
│   ├── utils.py
│   ├── api_calls.py
│   ├── results_handler.py
│   ├── response_utils.py
│   └── request_builders/
│       └── __init__.py
├── config/                        # Configuration files
│   ├── tests.csv
│   ├── environments.csv
│   ├── merchants.csv
│   ├── cards.csv
│   ├── address.csv
│   ├── networktoken.csv
│   └── threeddata.csv
├── outputs/                       # Test results (created automatically)
├── tests/                         # Unit tests
├── documentation/                 # Documentation files
└── requirements.txt               # Python dependencies
            </div>
        </div>

        <h2 id="project-setup">Project Setup</h2>

        <div class="step-box">
            <h4>Step 5: Copy Framework Code</h4>
            <p>Copy the payment testing framework source code into the <code>src/</code> directory. If you have the code from the files shown in the context, copy each file to its respective location.</p>
            
            <div class="alert alert-info">
                <strong>Code Source:</strong> Ensure you have all the Python files (main.py, data_loader.py, utils.py, api_calls.py, etc.) and copy them to the appropriate directories as shown in the project structure above.
            </div>
        </div>

        <div class="step-box">
            <h4>Step 6: Copy Unit Tests</h4>
            <p>Copy the unit test files to the <code>tests/</code> directory:</p>
            <pre><code># Example test files to copy (if available):
# tests/conftest.py
# tests/test_data_loader.py
# tests/test_response_utils.py
# tests/test_results_handler.py
# tests/test_utils.py
# tests/test_request_builders/ (directory with all builder tests)</code></pre>
        </div>

        <h2 id="configuration">Initial Configuration</h2>

        <div class="step-box">
            <h4>Step 7: Configure Environment</h4>
            <p>Set up your environment configuration file with your Worldline API credentials:</p>
            
            <p><strong>Edit <code>config/environments.csv</code>:</strong></p>
            <pre><code>env,integrator,endpoint_host,authorization_type,oauth2_token_uri,connect_timeout,socket_timeout,max_connections,client_id,client_secret
preprod,Your Integration Name,api.preprod.acquiring.worldline-solutions.com,OAuth2,https://auth-test-eu-west-1.aws.bambora.com/connect/token,5,300,10,YOUR_CLIENT_ID,YOUR_CLIENT_SECRET</code></pre>

            <div class="alert alert-warning">
                <strong>Important:</strong> Replace <code>YOUR_CLIENT_ID</code> and <code>YOUR_CLIENT_SECRET</code> with your actual Worldline API credentials. Never commit real credentials to version control.
            </div>
        </div>

        <div class="step-box">
            <h4>Step 8: Configure Test Merchants</h4>
            <p><strong>Edit <code>config/merchants.csv</code>:</strong></p>
            <pre><code>merchant,env,acquirer_id,merchant_id,merchant_description
merchant1,preprod,YOUR_ACQUIRER_ID,YOUR_MERCHANT_ID,Test Merchant Description</code></pre>

            <div class="alert alert-info">
                <strong>Note:</strong> Replace with your actual acquirer and merchant IDs provided by Worldline for testing.
            </div>
        </div>

        <div class="step-box">
            <h4>Step 9: Configure Test Cards</h4>
            <p><strong>Edit <code>config/cards.csv</code>:</strong></p>
            <pre><code>card_id,card_brand,card_bin,card_number,expiry_date,card_sequence_number,card_security_code,card_pin,card_description
card01,VISA,411111,4111111111111111,122025,,123,,Test Visa Card
card02,MASTERCARD,522222,5222222222222222,122025,,456,,Test Mastercard</code></pre>

            <div class="alert alert-warning">
                <strong>Test Cards Only:</strong> Only use test card numbers provided by Worldline. Never use real card numbers in testing.
            </div>
        </div>

        <div class="step-box">
            <h4>Step 10: Create Sample Test</h4>
            <p><strong>Edit <code>config/tests.csv</code>:</strong></p>
            <pre><code>chain_id,step_order,call_type,test_id,card_id,merchant_id,env,amount,currency,authorization_type,capture_immediately,card_entry_mode,cardholder_verification_method,dynamic_descriptor
chain1,1,create_payment,TEST001,card01,merchant1,preprod,1000,GBP,FINAL_AUTHORIZATION,FALSE,ECOMMERCE,CARD_SECURITY_CODE,Test Payment</code></pre>
        </div>

        <h2 id="verification">Verification</h2>

        <div class="step-box">
            <h4>Step 11: Verify Installation</h4>
            <p>Test that everything is set up correctly:</p>
            
            <p><strong>Test Python Environment:</strong></p>
            <pre><code># Verify virtual environment is active
which python
which pip

# Check installed packages
pip list

# Test import of key dependencies
python -c "import pandas; print('Pandas:', pandas.__version__)"
python -c "import sqlalchemy; print('SQLAlchemy:', sqlalchemy.__version__)"
python -c "from worldline.acquiring.sdk.factory import Factory; print('Worldline SDK: OK')"</code></pre>

            <p><strong>Test Configuration Loading:</strong></p>
            <pre><code># Test configuration file loading
python -c "from src.data_loader import load_data; print('Configuration loading: OK')"</code></pre>

            <p><strong>Run Unit Tests:</strong></p>
            <pre><code># Run all unit tests
pytest

# Run with verbose output
pytest -v

# Run specific test file
pytest tests/test_utils.py -v</code></pre>
        </div>

        <div class="step-box">
            <h4>Step 12: Test Basic Execution</h4>
            <p>Try a dry run of the framework:</p>
            <pre><code># Run help command
python -m src.main --help

# Test with sample configuration (may fail with API errors - that's expected)
python -m src.main --verbose</code></pre>

            <div class="alert alert-info">
                <strong>Expected Behavior:</strong> The framework should start and attempt to load configuration. API calls may fail if credentials aren't properly configured, but the framework should handle errors gracefully.
            </div>
        </div>

        <h2 id="troubleshooting">Troubleshooting</h2>

        <h3>Common Issues and Solutions</h3>

        <div class="alert alert-danger">
            <h4>ImportError: No module named 'src'</h4>
            <p><strong>Solution:</strong> Make sure you're running from the project root directory and using <code>python -m src.main</code> instead of <code>python src/main.py</code></p>
            <pre><code># Check current directory
pwd

# Should show: /path/to/payment-api-tester

# Run from project root
python -m src.main</code></pre>
        </div>

        <div class="alert alert-danger">
            <h4>Virtual Environment Not Active</h4>
            <p><strong>Symptoms:</strong> Command prompt doesn't show <code>(venv)</code></p>
            <p><strong>Solution:</strong> Activate the virtual environment:</p>
            <pre><code># Windows
venv\Scripts\activate

# macOS/Linux
source venv/bin/activate</code></pre>
        </div>

        <div class="alert alert-danger">
            <h4>Package Installation Fails</h4>
            <p><strong>Solution:</strong> Upgrade pip and try again:</p>
            <pre><code># Upgrade pip
pip install --upgrade pip

# Clear pip cache
pip cache purge

# Install with no cache
pip install --no-cache-dir package-name</code></pre>
        </div>

        <div class="alert alert-danger">
            <h4>Configuration File Errors</h4>
            <p><strong>Symptoms:</strong> "Environment X not defined" or "Merchant Y not defined"</p>
            <p><strong>Solution:</strong> Check CSV file format and content:</p>
            <pre><code># Validate CSV files
python -c "import pandas as pd; df = pd.read_csv('config/environments.csv'); print(df.head())"</code></pre>
        </div>

        <div class="alert alert-danger">
            <h4>API Authentication Errors</h4>
            <p><strong>Symptoms:</strong> HTTP 401 or authentication failures</p>
            <p><strong>Solutions:</strong></p>
            <ul>
                <li>Verify client_id and client_secret in environments.csv</li>
                <li>Check that OAuth2 token URI is correct</li>
                <li>Ensure your credentials are valid for the environment</li>
                <li>Contact Worldline support if credentials are uncertain</li>
            </ul>
        </div>

        <h3>Getting Help</h3>
        <p>If you encounter issues not covered here:</p>
        <ol>
            <li><strong>Check the logs:</strong> Run with <code>--verbose</code> flag for detailed output</li>
            <li><strong>Verify configuration:</strong> Double-check all CSV files for formatting and content</li>
            <li><strong>Test components individually:</strong> Run unit tests to isolate issues</li>
            <li><strong>Check dependencies:</strong> Ensure all required packages are installed</li>
        </ol>

        <h2 id="next-steps">Next Steps</h2>

        <div class="alert alert-success">
            <h4>🎉 Environment Setup Complete!</h4>
            <p>Your Payment API Testing Framework environment is now ready. Here's what to do next:</p>
            
            <ol>
                <li><strong>Review Documentation:</strong>
                    <ul>
                        <li><a href="configuration-guide.html">Configuration Guide</a> - Detailed CSV configuration</li>
                        <li><a href="user-guide.html">User Guide</a> - How to use the framework</li>
                        <li><a href="cli-reference.html">CLI Reference</a> - Command-line options</li>
                    </ul>
                </li>
                <li><strong>Configure Your Tests:</strong>
                    <ul>
                        <li>Add your actual Worldline API credentials</li>
                        <li>Configure merchants for your environment</li>
                        <li>Create test scenarios in tests.csv</li>
                    </ul>
                </li>
                <li><strong>Run Your First Tests:</strong>
                    <ul>
                        <li>Start with simple payment creation tests</li>
                        <li>Use <code>--verbose</code> flag for debugging</li>
                        <li>Review results in <code>outputs/results.csv</code></li>
                    </ul>
                </li>
                <li><strong>Scale Up:</strong>
                    <ul>
                        <li>Add more complex test chains</li>
                        <li>Use parallel execution with <code>--threads</code></li>
                        <li>Set up automated test schedules</li>
                    </ul>
                </li>
            </ol>
        </div>

        <h3>Quick Reference Commands</h3>
        <pre><code># Activate virtual environment
source venv/bin/activate  # macOS/Linux
venv\Scripts\activate      # Windows

# Run tests with default settings
python -m src.main

# Run tests with custom file and parallel execution
python -m src.main --tests config/my_tests.csv --threads 3 --verbose

# Run unit tests
pytest

# View results
cat outputs/results.csv</code></pre>
    </div>

    <script>
        function showPlatform(platformId) {
            // Hide all platform content
            var contents = document.querySelectorAll('.platform-content');
            contents.forEach(function(content) {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            var tabs = document.querySelectorAll('.platform-tab');
            tabs.forEach(function(tab) {
                tab.classList.remove('active');
            });
            
            // Show selected platform content
            document.getElementById(platformId).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
    </script>
</body>
</html>